# 合并二叉树 - 交互设计规范

本文档详细规定了合并二叉树可视化动画的交互设计规范，包括界面布局、交互组件、操作响应、状态转换等内容，确保用户获得一致且高效的交互体验。

## 一、界面布局规范

### 1.1 整体布局

界面采用三区域布局，为不同分辨率设备提供良好的适配性：

| 区域 | 位置 | 功能 |
|-----|------|-----|
| 树可视化区域 | 上部，占据70%高度 | 显示两棵原始树和合并结果树的可视化 |
| 控制面板区域 | 下部左侧，占据30%高度和70%宽度 | 包含所有交互控件和当前步骤说明 |
| 代码/队列可视化区域 | 下部右侧，占据30%高度和30%宽度 | 显示当前操作的代码或队列/栈状态 |

**响应式设计原则：**
- 在窄屏设备上，三个区域垂直排列
- 在宽屏设备上，保持上述布局比例
- 触屏设备和桌面设备采用相同的交互逻辑，但控件尺寸调整以适应触摸操作

### 1.2 可视化区域布局

树的可视化展示遵循以下布局：

| 元素 | 位置 | 描述 |
|-----|------|-----|
| 第一棵树 | 左上部分 | 蓝色标记，标题"Tree 1" |
| 第二棵树 | 右上部分 | 橙色标记，标题"Tree 2" |
| 合并结果树 | 下部中央 | 绿色标记，标题"Merged Tree" |
| 节点连接线 | 连接各树节点 | 线条颜色与对应树一致 |
| 当前操作指示器 | 动态位置 | 高亮当前正在处理的节点或路径 |

**节点布局规则：**
- 节点间水平距离：自动计算以保持树的平衡可视化
- 节点间垂直距离：固定值，确保层次清晰可辨
- 节点大小：直径40px（默认），高亮状态48px

## 二、交互控件规范

### 2.1 控制面板组件

#### 2.1.1 算法选择控件

- **类型**：单选按钮组(Radio Button Group)
- **选项**：
  - DFS (深度优先搜索)
  - BFS (广度优先搜索)
- **默认值**：DFS
- **布局**：水平排列，左对齐
- **样式**：
  - 选中状态：背景色 #4285F4，文字白色
  - 未选中状态：背景色 #F5F5F5，文字深灰色
  - 圆角：4px
  - 内边距：8px 16px

#### 2.1.2 播放控制组

- **组件**：
  1. **播放/暂停按钮**
     - 图标：播放(▶)/暂停(⏸)
     - 尺寸：48px × 48px
     - 状态：
       - 播放状态显示暂停图标
       - 暂停状态显示播放图标
  
  2. **上一步按钮**
     - 图标：左箭头(◀)
     - 尺寸：40px × 40px
     - 状态：
       - 首步禁用(灰色)
       - 可用状态(蓝色)
  
  3. **下一步按钮**
     - 图标：右箭头(▶)
     - 尺寸：40px × 40px
     - 状态：
       - 末步禁用(灰色)
       - 可用状态(蓝色)
  
  4. **重置按钮**
     - 图标：循环箭头(↺)
     - 尺寸：40px × 40px
     - 颜色：#757575

- **布局**：水平排列，居中对齐，间距12px
- **分组**：使用微妙的边框或背景色分组

#### 2.1.3 速度控制滑块

- **类型**：滑块(Slider)
- **范围**：0.5x - 2.0x
- **默认值**：1.0x
- **刻度**：[0.5x, 0.75x, 1.0x, 1.5x, 2.0x]
- **样式**：
  - 轨道高度：4px
  - 轨道颜色：#E0E0E0
  - 已完成部分颜色：#4285F4
  - 滑块直径：16px
  - 滑块颜色：#4285F4
- **标签**：当前速度值显示在滑块右侧，格式"1.0x"

#### 2.1.4 步骤进度指示器

- **类型**：进度条 + 文本标签
- **组件**：
  1. **进度条**
     - 高度：6px
     - 颜色：#E0E0E0(背景)，#4285F4(已完成部分)
     - 可点击：用户可点击进度条直接跳转到对应步骤
  
  2. **步骤计数器**
     - 格式："步骤 X / Y"，X为当前步骤，Y为总步骤
     - 字体：14px，#757575

- **布局**：进度条在上，计数器在下，右对齐

#### 2.1.5 步骤说明面板

- **类型**：文本面板
- **内容**：
  1. **标题**：当前步骤的简短标题(例如"合并根节点")
     - 字体：16px粗体，#212121
  
  2. **详细说明**：当前步骤的详细解释
     - 字体：14px常规，#424242
     - 最大高度：120px，超出显示滚动条

- **样式**：
  - 背景色：#F9F9F9
  - 边框：1px实线，#E0E0E0
  - 圆角：4px
  - 内边距：16px

### 2.2 代码/队列可视化区域

#### 2.2.1 标签页控件

- **类型**：选项卡(Tabs)
- **选项**：
  - 代码视图
  - 队列/栈视图
- **样式**：
  - 选中标签：底部边框 2px，#4285F4
  - 未选中标签：无边框，#757575
  - 字体：14px

#### 2.2.2 代码视图

- **类型**：代码块
- **功能**：
  - 显示当前执行的代码行
  - 高亮当前执行行
- **样式**：
  - 字体：等宽字体，14px
  - 行号：左侧显示，#9E9E9E
  - 高亮行：背景色 #E3F2FD
  - 语法高亮：使用标准TypeScript语法高亮

#### 2.2.3 队列/栈视图

- **类型**：图形化队列/栈表示
- **功能**：
  - BFS模式：显示三个队列的当前状态
  - DFS模式：显示递归调用栈
- **样式**：
  - 队列/栈元素：圆角矩形，内含节点值
  - 颜色编码：与树节点保持一致
  - 操作指示：入队/出队/入栈/出栈动画

## 三、交互响应规范

### 3.1 用户操作响应

| 操作 | 响应 | 动画效果 |
|-----|------|---------|
| 点击播放按钮 | 开始/暂停自动播放 | 按钮图标切换动画 |
| 点击下一步 | 前进到下一步骤 | 节点状态平滑过渡，持续300ms |
| 点击上一步 | 返回到上一步骤 | 节点状态平滑过渡，持续300ms |
| 点击重置 | 重置到初始状态 | 全局重置动画，持续500ms |
| 调整速度滑块 | 更改播放速度 | 无动画，立即生效 |
| 点击进度条 | 跳转到对应步骤 | 节点状态快速过渡，持续200ms |
| 切换算法 | 切换到所选算法的初始状态 | 全局淡出淡入动画，持续800ms |
| 点击代码/队列标签 | 切换视图 | 标签页滑动切换动画 |

### 3.2 状态转换规则

1. **播放状态转换**
   - 暂停→播放：点击播放按钮，或当前在最终步骤时点击重置后自动开始
   - 播放→暂停：点击暂停按钮，或到达最终步骤，或用户点击上一步/下一步

2. **步骤转换规则**
   - 首步：禁用上一步按钮
   - 末步：禁用下一步按钮，自动暂停播放
   - 中间步骤：启用上一步和下一步按钮

3. **速度调整规则**
   - 实时生效，无需暂停
   - 播放间隔 = 基准间隔(1000ms) / 速度值

4. **算法切换规则**
   - 自动暂停当前播放
   - 重置到新算法的初始状态
   - 保留当前速度设置

## 四、动画与过渡效果

### 4.1 节点状态变化动画

- **属性变化**：所有节点属性变化(大小、颜色、透明度)使用CSS过渡动画
- **持续时间**：
  - 普通变化：300ms
  - 强调变化：500ms
- **缓动函数**：ease-in-out

### 4.2 树结构变化动画

- **节点添加**：淡入效果，从透明度0到1
- **节点移动**：位置变化使用平滑过渡
- **边创建**：线条从起点逐渐延伸到终点
- **持续时间**：500ms
- **缓动函数**：ease-out

### 4.3 队列/栈操作动画

- **入队/入栈**：元素从右侧滑入
- **出队/出栈**：元素淡出并左移
- **持续时间**：400ms
- **缓动函数**：ease-in-out

### 4.4 算法切换动画

- **切换效果**：整体淡出后淡入新算法视图
- **树结构保持**：保持树的基本形状和位置
- **持续时间**：800ms(淡出400ms + 淡入400ms)
- **缓动函数**：ease

## 五、可访问性规范

### 5.1 键盘操作支持

- **Tab键导航**：所有交互元素可通过Tab键依次聚焦
- **空格/回车键**：激活当前聚焦的按钮
- **箭头键**：
  - 左/右箭头：控制上一步/下一步
  - 上/下箭头：调整速度滑块值
- **Esc键**：暂停当前播放

### 5.2 屏幕阅读器支持

- **ARIA角色**：为所有UI组件添加适当的ARIA角色
- **状态描述**：所有状态变化提供适当的屏幕阅读器通知
- **替代文本**：为所有视觉元素提供文本替代描述

### 5.3 颜色对比度

- **文本对比度**：所有文本符合WCAG 2.1 AA级对比度要求(4.5:1)
- **操作元素对比度**：所有交互元素符合3:1最小对比度要求
- **颜色无关信息**：除颜色外，使用形状、标签等辅助区分元素

## 六、移动端适配规范

### 6.1 响应式设计断点

| 设备类型 | 屏幕宽度范围 | 布局调整 |
|---------|------------|---------|
| 手机 | < 600px | 垂直堆叠三个主要区域 |
| 平板 | 600px - 1024px | 树区域在上，控制面板和代码/队列区域水平排列在下 |
| 桌面 | > 1024px | 标准三区域布局 |

### 6.2 触摸操作优化

- **最小触摸区域**：所有可交互元素至少48px × 48px
- **触摸反馈**：点击时提供视觉反馈
- **手势支持**：
  - 左右滑动：切换步骤
  - 双指缩放：调整树的查看比例
  - 单指拖动：在放大状态下平移视图

### 6.3 屏幕方向处理

- **横屏模式**：首选布局，最佳体验
- **竖屏模式**：自动调整至垂直堆叠布局
- **方向切换**：保留当前步骤和状态

## 七、性能优化指南

### 7.1 动画性能优化

- **使用CSS属性动画**：优先使用transform和opacity属性
- **避免频繁重绘**：最小化样式计算和布局触发
- **动画节流**：在低端设备上自动降低动画复杂度

### 7.2 资源加载策略

- **延迟加载**：非关键资源采用延迟加载
- **预加载**：预加载下一步需要的资源
- **缓存策略**：缓存已计算的动画步骤状态

### 7.3 体验优化

- **渐进式增强**：确保基本功能在所有环境中可用
- **加载状态**：显示加载指示器和进度
- **错误恢复**：提供错误状态处理和恢复机制

## 八、实现技术栈推荐

- **前端框架**：React或Vue.js
- **动画库**：GSAP或React Spring
- **图形渲染**：D3.js(树可视化)或自定义Canvas渲染
- **UI组件库**：Material-UI或Ant Design
- **代码高亮**：Prism.js或Highlight.js

---

本文档作为合并二叉树可视化动画的交互设计规范，应与算法实现文档和动画分镜文档配合使用，确保最终实现的一致性和高质量的用户体验。 